

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Global Optimization with Gaussian Processes: Part1 &#8212; ML Extra Material</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/BO_Intro';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Global Optimization with Gaussian Processes: Part2" href="BO_hyperparameter.html" />
    <link rel="prev" title="Bayesian Optimization" href="BO_description.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/ml_logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/ml_logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    ML Extra Material
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="BO_description.html">Bayesian Optimization</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Global Optimization with Gaussian Processes: Part1</a></li>
<li class="toctree-l1"><a class="reference internal" href="BO_hyperparameter.html">Global Optimization with Gaussian Processes: Part2</a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fcontent/BO_Intro.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/content/BO_Intro.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Global Optimization with Gaussian Processes: Part1</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-started">1. Getting started</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#remembering-the-basics">Remembering the basics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#running-example">Running example</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="global-optimization-with-gaussian-processes-part1">
<h1>Global Optimization with Gaussian Processes: Part1<a class="headerlink" href="#global-optimization-with-gaussian-processes-part1" title="Permalink to this heading">#</a></h1>
<p>The goal of this notebook is to illustrate the basic concepts of Bayesian optimization using Gausian Processes. We will focus on two aspects of Bayesian Optimization (BO): (1) the choice of the model (2) the choice of the acquisition function.</p>
<section id="getting-started">
<h2>1. Getting started<a class="headerlink" href="#getting-started" title="Permalink to this heading">#</a></h2>
<p>In addition to GPy, this lab uses <a class="reference external" href="http://sheffieldml.github.io/GPy/">GPyOpt</a>, a satellite module of GPy useful to solve global optimization problems. Please be sure that it is correctly installed before starting. The easiest way is using pip. In Ubuntu machines you can do:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="ch">#!pip install GPy==1.10.0</span>
<span class="c1">#!pip install GPyOpt==1.2.1</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s import the required libraries.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline  
<span class="kn">import</span> <span class="nn">GPy</span>
<span class="kn">import</span> <span class="nn">GPyOpt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">seed</span>
<span class="n">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="remembering-the-basics">
<h3>Remembering the basics<a class="headerlink" href="#remembering-the-basics" title="Permalink to this heading">#</a></h3>
<p>Before starting with the lab, remember that (BO) is an heuristic for global optimization of black-box functions. Let <span class="math notranslate nohighlight">\(f: {\mathcal X} \to R\)</span> be a ‘well behaved’ continuous function defined on a compact subset <span class="math notranslate nohighlight">\({\mathcal X} \subseteq R^d\)</span>. Our goal is to solve the global optimization problem of finding
$<span class="math notranslate nohighlight">\( x_{M} = \arg \min_{x \in {\mathcal X}} f(x). \)</span>$</p>
<p>We assume that <span class="math notranslate nohighlight">\(f\)</span> is a <em>black-box</em> from which only perturbed evaluations of the type <span class="math notranslate nohighlight">\(y_i = f(x_i) + \epsilon_i\)</span>, with <span class="math notranslate nohighlight">\(\epsilon_i \sim\mathcal{N}(0,\sigma^2)\)</span>, are  available. The goal is to find <span class="math notranslate nohighlight">\(x_M\)</span> by minimizing the number of evaluations of <span class="math notranslate nohighlight">\(f\)</span>. To do this, we need to determine two crucial bits:</p>
<ol class="arabic simple">
<li><p>A <strong>Gaussian process</strong> that will capture the our beliefs on <span class="math notranslate nohighlight">\(f\)</span>.</p></li>
<li><p>An <strong>acquisition function</strong> that based on the model will be useful to determine where to collect new evaluations of f.</p></li>
</ol>
<p>Remember that every time a new data point is collected the model is updated and the acquisition function optimized again.</p>
</section>
<section id="running-example">
<h3>Running example<a class="headerlink" href="#running-example" title="Permalink to this heading">#</a></h3>
<p>We start with a one-dimensional example. Consider here the Forrester function</p>
<p>$<span class="math notranslate nohighlight">\(f(x) =(6x-2)^2 \sin(12x-4),\)</span><span class="math notranslate nohighlight">\( defined on the interval \)</span>[0, 1]$.</p>
<p>The minimum of this function is located at <span class="math notranslate nohighlight">\(x_{min}=0.78\)</span>. We assume that the evaluations of <span class="math notranslate nohighlight">\(f\)</span> to are perturbed by zero-mean Gaussian noise with standard deviation 0.25. The Forrester function is part of the benchmark of functions of GPyOpt. To create the true function, the perturbed version and the boundaries of the problem you need to run the following cell.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the true and perturbed Forrester function and the boundaries of the problem</span>
<span class="n">f_true</span><span class="o">=</span> <span class="n">GPyOpt</span><span class="o">.</span><span class="n">objective_examples</span><span class="o">.</span><span class="n">experiments1d</span><span class="o">.</span><span class="n">forrester</span><span class="p">()</span>          <span class="c1"># noisy version</span>
<span class="n">bounds</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;var_1&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;continuous&#39;</span><span class="p">,</span> <span class="s1">&#39;domain&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)}]</span>  <span class="c1"># problem constraints </span>
</pre></div>
</div>
</div>
</div>
<p>To plot the true <span class="math notranslate nohighlight">\(f\)</span>, simply write:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_true</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6e5dff32d398cf6e2d5aabfdeb267a0268a72606322bc39daca618aade42e766.png" src="../_images/6e5dff32d398cf6e2d5aabfdeb267a0268a72606322bc39daca618aade42e766.png" />
</div>
</div>
<p>f_true contains the function that we are going to optimize. You can define your own objective but it should be able to map any numpy array of dimension <span class="math notranslate nohighlight">\(n\times d\)</span> (inputs) to a numpy array of dimension <span class="math notranslate nohighlight">\(n\times 1\)</span> (outputs). For instance:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.92961609],
       [0.31637555],
       [0.18391881],
       [0.20456028],
       [0.56772503],
       [0.5955447 ],
       [0.96451452],
       [0.6531771 ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_true</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 9.80154240e+00],
       [-2.09213242e-03],
       [-7.83934370e-01],
       [-5.96775608e-01],
       [ 6.38826042e-01],
       [-1.22366657e-02],
       [ 1.37842479e+01],
       [-2.36274433e+00]])
</pre></div>
</div>
</div>
</div>
<p>To use BO to solve this problem, we need to create a GPyOpt object in which we need to specify the following elements:</p>
<ul class="simple">
<li><p>The function to optimize.</p></li>
<li><p>The box constrains of the problem.</p></li>
<li><p>The model, that is fixed by default to be a GP with a SE kernel.</p></li>
<li><p>The acquisition function (and its parameters).</p></li>
</ul>
<p>We create an SE kernel as we do in GPy</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="n">GPy</span><span class="o">.</span><span class="n">kern</span><span class="o">.</span><span class="n">RBF</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>And now we have all the elements to start optimizing <span class="math notranslate nohighlight">\(f\)</span>. We create the optimization problem instance. Note that you don’t need to specify the evaluation budget of. This is because at this stage we are not running the optimization, we are just initializing the different elements of the BO algorithm.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creates GPyOpt object with the model and anquisition fucntion</span>
<span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">myBopt</span> <span class="o">=</span> <span class="n">GPyOpt</span><span class="o">.</span><span class="n">methods</span><span class="o">.</span><span class="n">BayesianOptimization</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f_true</span><span class="o">.</span><span class="n">f</span><span class="p">,</span>            <span class="c1"># function to optimize       </span>
                                             <span class="n">domain</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>        <span class="c1"># box-constraints of the problem</span>
                                             <span class="n">acquisition_type</span><span class="o">=</span><span class="s1">&#39;EI&#39;</span><span class="p">,</span>
                                             <span class="n">initial_design_numdata</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                             <span class="n">kernel</span> <span class="o">=</span> <span class="n">k</span><span class="p">,</span>
                                             <span class="n">exact_feval</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="c1"># Selects the Expected improvement</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">?</span>GPyOpt.methods.BayesianOptimization
</pre></div>
</div>
</div>
</div>
<p>At this point you can access to a number of elements in myBopt, including the GP model and the current dataset (initialized at 3 random locations by default).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">myBopt</span><span class="o">.</span><span class="n">X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.69646919],
       [0.28613933],
       [0.22685145]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">myBopt</span><span class="o">.</span><span class="n">Y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-4.45162646],
       [-0.04302052],
       [-0.39078442]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">myBopt</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">kernel</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
.tg  {font-family:"Courier New", Courier, monospace !important;padding:2px 3px;word-break:normal;border-collapse:collapse;border-spacing:0;border-color:#DCDCDC;margin:0px auto;width:100%;}
.tg td{font-family:"Courier New", Courier, monospace !important;font-weight:bold;color:#444;background-color:#F7FDFA;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#DCDCDC;}
.tg th{font-family:"Courier New", Courier, monospace !important;font-weight:normal;color:#fff;background-color:#26ADE4;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#DCDCDC;}
.tg .tg-left{font-family:"Courier New", Courier, monospace !important;font-weight:normal;text-align:left;}
.tg .tg-center{font-family:"Courier New", Courier, monospace !important;font-weight:normal;text-align:center;}
.tg .tg-right{font-family:"Courier New", Courier, monospace !important;font-weight:normal;text-align:right;}
</style>
<table class="tg"><tr><th><b>  rbf.       </b></th><th><b>value</b></th><th><b>constraints</b></th><th><b>priors</b></th></tr>
<tr><td class=tg-left>  variance   </td><td class=tg-right>  1.0</td><td class=tg-center>    +ve    </td><td class=tg-center>      </td></tr>
<tr><td class=tg-left>  lengthscale</td><td class=tg-right>  1.0</td><td class=tg-center>    +ve    </td><td class=tg-center>      </td></tr>
</table></div></div>
</div>
<p>The noise variance is automatically bounded to avoid numerical problems. In case of having a problem where the evaluations of <span class="math notranslate nohighlight">\(f\)</span> are exact you only need to include ‘exact_feval=True’ when creating the BO object as above. Now, to run the optimization for certain number of iterations you only need to write:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run the optimization</span>
<span class="n">max_iter</span> <span class="o">=</span> <span class="mi">15</span>     <span class="c1"># evaluation budget</span>
<span class="n">max_time</span> <span class="o">=</span> <span class="mi">60</span>     <span class="c1"># time budget </span>
<span class="n">eps</span>      <span class="o">=</span> <span class="mf">10e-6</span>  <span class="c1"># Minimum allows distance between the las two observations</span>

<span class="n">myBopt</span><span class="o">.</span><span class="n">run_optimization</span><span class="p">(</span><span class="n">max_iter</span><span class="p">,</span> <span class="n">max_time</span><span class="p">,</span> <span class="n">eps</span><span class="p">)</span>   
</pre></div>
</div>
</div>
</div>
<p>And that’s it! You should have receive a message describing if the method converged (two equal x’s are selected in consecutive steps of the optimization) or if the maximum number of iterations was reached. In one dimensional examples, you can visualize the model and the acquisition function (normalized between 0 and 1) as follows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">myBopt</span><span class="o">.</span><span class="n">plot_acquisition</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [14],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">myBopt</span><span class="o">.</span><span class="n">plot_acquisition</span><span class="p">()</span>

<span class="nn">File ~/opt/anaconda3/envs/my_pytorch/lib/python3.9/site-packages/GPyOpt/core/bo.py:265,</span> in <span class="ni">BO.plot_acquisition</span><span class="nt">(self, filename)</span>
<span class="g g-Whitespace">    </span><span class="mi">258</span> <span class="k">def</span> <span class="nf">plot_acquisition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">259</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">260</span><span class="sd">     Plots the model and the acquisition function.</span>
<span class="g g-Whitespace">    </span><span class="mi">261</span><span class="sd">         if self.input_dim = 1: Plots data, mean and variance in one plot and the acquisition function in another plot</span>
<span class="g g-Whitespace">    </span><span class="mi">262</span><span class="sd">         if self.input_dim = 2: as before but it separates the mean and variance of the model in two different plots</span>
<span class="g g-Whitespace">    </span><span class="mi">263</span><span class="sd">     :param filename: name of the file where the plot is saved</span>
<span class="g g-Whitespace">    </span><span class="mi">264</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">265</span>     <span class="k">return</span> <span class="n">plot_acquisition</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">acquisition</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">get_bounds</span><span class="p">(),</span>
<span class="g g-Whitespace">    </span><span class="mi">266</span>                             <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="g g-Whitespace">    </span><span class="mi">267</span>                             <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">268</span>                             <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">X</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">269</span>                             <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">270</span>                             <span class="bp">self</span><span class="o">.</span><span class="n">acquisition</span><span class="o">.</span><span class="n">acquisition_function</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">271</span>                             <span class="bp">self</span><span class="o">.</span><span class="n">suggest_next_locations</span><span class="p">(),</span>
<span class="g g-Whitespace">    </span><span class="mi">272</span>                             <span class="n">filename</span><span class="p">)</span>

<span class="nn">File ~/opt/anaconda3/envs/my_pytorch/lib/python3.9/site-packages/GPyOpt/plotting/plots_bo.py:57,</span> in <span class="ni">plot_acquisition</span><span class="nt">(bounds, input_dim, model, Xdata, Ydata, acquisition_function, suggested_sample, filename)</span>
<span class="g g-Whitespace">     </span><span class="mi">53</span> <span class="n">acqu_normalized</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">acqu</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="o">-</span><span class="n">acqu</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">acqu</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="o">-</span><span class="n">acqu</span><span class="p">)))</span>
<span class="g g-Whitespace">     </span><span class="mi">54</span> <span class="n">m</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_grid</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">57</span> <span class="n">model</span><span class="o">.</span><span class="n">plot_density</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">59</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_grid</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">60</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_grid</span><span class="p">,</span> <span class="n">m</span><span class="o">-</span><span class="mf">1.96</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>

<span class="nn">File ~/opt/anaconda3/envs/my_pytorch/lib/python3.9/site-packages/GPy/plotting/gpy_plot/gp_plots.py:257,</span> in <span class="ni">plot_density</span><span class="nt">(self, plot_limits, fixed_inputs, resolution, plot_raw, apply_link, visible_dims, which_data_ycols, levels, label, predict_kw, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">252</span> <span class="n">helper_data</span> <span class="o">=</span> <span class="n">helper_for_plot_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">plot_limits</span><span class="p">,</span> <span class="n">visible_dims</span><span class="p">,</span> <span class="n">fixed_inputs</span><span class="p">,</span> <span class="n">resolution</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">253</span> <span class="n">helper_prediction</span> <span class="o">=</span> <span class="n">helper_predict_with_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">helper_data</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">plot_raw</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">254</span>                                       <span class="n">apply_link</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">,</span> <span class="n">levels</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">255</span>                                       <span class="n">get_which_data_ycols</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">which_data_ycols</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">256</span>                                       <span class="n">predict_kw</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">257</span> <span class="n">plots</span> <span class="o">=</span> <span class="n">_plot_density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">canvas</span><span class="p">,</span> <span class="n">helper_data</span><span class="p">,</span> <span class="n">helper_prediction</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">258</span> <span class="k">return</span> <span class="n">pl</span><span class="p">()</span><span class="o">.</span><span class="n">add_to_canvas</span><span class="p">(</span><span class="n">canvas</span><span class="p">,</span> <span class="n">plots</span><span class="p">)</span>

<span class="nn">File ~/opt/anaconda3/envs/my_pytorch/lib/python3.9/site-packages/GPy/plotting/gpy_plot/gp_plots.py:271,</span> in <span class="ni">_plot_density</span><span class="nt">(self, canvas, helper_data, helper_prediction, label, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">269</span>     <span class="n">fills</span> <span class="o">=</span> <span class="p">[]</span>
<span class="g g-Whitespace">    </span><span class="mi">270</span>     <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">mu</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
<span class="ne">--&gt; </span><span class="mi">271</span>         <span class="n">fills</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pl</span><span class="p">()</span><span class="o">.</span><span class="n">fill_gradient</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">272</span>             <span class="n">canvas</span><span class="p">,</span> <span class="n">Xgrid</span><span class="p">[:,</span> <span class="n">free_dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">p</span><span class="p">[:,</span><span class="n">d</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">percs</span><span class="p">],</span> 
<span class="g g-Whitespace">    </span><span class="mi">273</span>             <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">274</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">275</span>     <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">gpdensity</span><span class="o">=</span><span class="n">fills</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">276</span> <span class="k">else</span><span class="p">:</span>

<span class="nn">File ~/opt/anaconda3/envs/my_pytorch/lib/python3.9/site-packages/GPy/plotting/matplot_dep/plot_definitions.py:244,</span> in <span class="ni">MatplotlibPlots.fill_gradient</span><span class="nt">(self, canvas, X, percentiles, color, label, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">242</span>     <span class="kn">from</span> <span class="nn">matplotlib.mlab</span> <span class="kn">import</span> <span class="n">contiguous_regions</span>
<span class="g g-Whitespace">    </span><span class="mi">243</span> <span class="c1"># Handle united data, such as dates</span>
<span class="ne">--&gt; </span><span class="mi">244</span> <span class="n">ax</span><span class="o">.</span><span class="n">_process_unit_info</span><span class="p">(</span><span class="n">xdata</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">ydata</span><span class="o">=</span><span class="n">y1</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">245</span> <span class="n">ax</span><span class="o">.</span><span class="n">_process_unit_info</span><span class="p">(</span><span class="n">ydata</span><span class="o">=</span><span class="n">y2</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">246</span> <span class="c1"># Convert the arrays so we can work with them</span>

<span class="ne">TypeError</span>: _process_unit_info() got an unexpected keyword argument &#39;xdata&#39;
</pre></div>
</div>
<img alt="../_images/a889f6ea422b0aa87c4999634c4ac919ccd0c965efd79cf4882f0af6ff11bb98.png" src="../_images/a889f6ea422b0aa87c4999634c4ac919ccd0c965efd79cf4882f0af6ff11bb98.png" />
</div>
</div>
<p>You can only make the previous plot if the dimension of the problem is 1 or 2. However, you can always how the optimization evolved by running:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">myBopt</span><span class="o">.</span><span class="n">plot_convergence</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2df8486a6046fc67df82b5d5cf3bfafec83dee960c373dd4b842f79a7c7399d7.png" src="../_images/2df8486a6046fc67df82b5d5cf3bfafec83dee960c373dd4b842f79a7c7399d7.png" />
</div>
</div>
<p>The first plot shows the distance between the last two collected observations at each iteration. This plot is useful to evaluate the convergence of the method. The second plot shows the best found value at each iteration. It is useful to compare different methods. The fastest the curve decreases the best is the method. The last one shows the predicted sdev. at the next location. This plot is useful to study the exploration/exploitation that is carried out at each step of the optimization. See how the method converged after 10 iterations. You can also print the updated GP</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">myBopt</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">model</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
.pd{
    font-family: "Courier New", Courier, monospace !important;
    width: 100%;
    padding: 3px;
}
</style>

<p class=pd>
<b>Model</b>: GP regression<br>
<b>Objective</b>: -42.11139405773658<br>
<b>Number of Parameters</b>: 3<br>
<b>Number of Optimization Parameters</b>: 2<br>
<b>Updates</b>: True<br>
</p>
<style type="text/css">
.tg  {font-family:"Courier New", Courier, monospace !important;padding:2px 3px;word-break:normal;border-collapse:collapse;border-spacing:0;border-color:#DCDCDC;margin:0px auto;width:100%;}
.tg td{font-family:"Courier New", Courier, monospace !important;font-weight:bold;color:#444;background-color:#F7FDFA;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#DCDCDC;}
.tg th{font-family:"Courier New", Courier, monospace !important;font-weight:normal;color:#fff;background-color:#26ADE4;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#DCDCDC;}
.tg .tg-left{font-family:"Courier New", Courier, monospace !important;font-weight:normal;text-align:left;}
.tg .tg-center{font-family:"Courier New", Courier, monospace !important;font-weight:normal;text-align:center;}
.tg .tg-right{font-family:"Courier New", Courier, monospace !important;font-weight:normal;text-align:right;}
</style>
<table class="tg"><tr><th><b>  GP_regression.         </b></th><th><b>              value</b></th><th><b>constraints</b></th><th><b>priors</b></th></tr>
<tr><td class=tg-left>  rbf.variance           </td><td class=tg-right>  3.522037639136576</td><td class=tg-center>    +ve    </td><td class=tg-center>      </td></tr>
<tr><td class=tg-left>  rbf.lengthscale        </td><td class=tg-right>0.17550907043767763</td><td class=tg-center>    +ve    </td><td class=tg-center>      </td></tr>
<tr><td class=tg-left>  Gaussian_noise.variance</td><td class=tg-right>              1e-06</td><td class=tg-center> +ve fixed </td><td class=tg-center>      </td></tr>
</table></div></div>
</div>
</section>
<section id="exercise-1">
<h3>Exercise 1<a class="headerlink" href="#exercise-1" title="Permalink to this heading">#</a></h3>
<p>Use Bayesian optimization to find the minimum of the function <span class="math notranslate nohighlight">\(f(x)= x^2 + 10 \sin(x)\)</span> in the interval [-10, 10].</p>
<p>1.1 Define the bounds of the problem, the function and check that it admits a numpy array of observations as input.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Answer to 1.1 here:</span>
</pre></div>
</div>
</div>
</div>
<p>1.2 Create a GPyOpt object for global optimization using a Mattern52 kernel.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Answer to 1.2 here:</span>
</pre></div>
</div>
</div>
</div>
<p>1.3 Run the optimization for 10 iterations. Make and comment the convergence plots. Has the method converged?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Answer to 1.4 here:</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-2">
<h3>Exercise 2<a class="headerlink" href="#exercise-2" title="Permalink to this heading">#</a></h3>
<p>Consider the sixhumpcamel function defined as
$<span class="math notranslate nohighlight">\(f(x_1,x_2) = \left(4-2.1x_1^2 + \frac{x_1^4}{3} \right)x_1^2 + x_1x_2 + (-4 +4x_2^2)x_2^2,\)</span>$</p>
<p>in <span class="math notranslate nohighlight">\([-2,2]\times [-1,1]\)</span>. This function has two global minima, at <span class="math notranslate nohighlight">\((0.0898,-0.7126)\)</span> and <span class="math notranslate nohighlight">\((-0.0898,0.7126)\)</span>. This function is also implemented in GPyOpt so, to load and visualize it simply run.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GPyOpt</span><span class="o">.</span><span class="n">fmodels</span><span class="o">.</span><span class="n">experiments2d</span><span class="o">.</span><span class="n">sixhumpcamel</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">f_shc</span> <span class="o">=</span> <span class="n">GPyOpt</span><span class="o">.</span><span class="n">fmodels</span><span class="o">.</span><span class="n">experiments2d</span><span class="o">.</span><span class="n">sixhumpcamel</span><span class="p">(</span><span class="n">sd</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">f</span>  <span class="c1"># simulated version with some noise</span>
<span class="n">bounds_shc</span> <span class="o">=</span> <span class="n">GPyOpt</span><span class="o">.</span><span class="n">fmodels</span><span class="o">.</span><span class="n">experiments2d</span><span class="o">.</span><span class="n">sixhumpcamel</span><span class="p">()</span><span class="o">.</span><span class="n">bounds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/32a392f74c1d4122ad6bdebb4716a155e4404d9dbd09dee3430bb8e6177bc8fb.png" src="../_images/32a392f74c1d4122ad6bdebb4716a155e4404d9dbd09dee3430bb8e6177bc8fb.png" />
</div>
</div>
<p>2.1 Create three objects to optimize this function using the the ‘EI’ and ‘MPI’. Use the same initial data in the three cases (Hint: use the options ‘X’ and ‘Y’ when creating the BO object).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Answer to 2.1</span>
</pre></div>
</div>
</div>
</div>
<p>2.2 In the two cases run the optimization for 30 iterations</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Answer to 2.2 here:</span>
</pre></div>
</div>
</div>
</div>
<p>2.3 Now make a plot comparing the two methods. The x axis should contain the number of iterations and y axis the best found value (Hint: use .Y_best to extract from the BO objects the best current value at each iteration). Which acquisition has the best performance in this example?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Answer to 2.3 here:</span>
</pre></div>
</div>
</div>
</div>
<p>2.4 Compare the models and the acquisition functions in the two cases (after the 30 iterations). What do you observe?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Answer to 3.4 here:</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="BO_description.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Bayesian Optimization</p>
      </div>
    </a>
    <a class="right-next"
       href="BO_hyperparameter.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Global Optimization with Gaussian Processes: Part2</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-started">1. Getting started</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#remembering-the-basics">Remembering the basics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#running-example">Running example</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Julián D. Arias-Londoño
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>